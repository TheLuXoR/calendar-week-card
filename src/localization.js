export const FALLBACK_LANGUAGE = "en";

export const TRANSLATIONS = {
    en: {
        today: "Today",
        allDay: "All day",
        allDayShort: "All-day",
        allDayAbbrev: "All",
        location: "Location",
        description: "Description",
        calendarColors: "Calendar Colors",
        supportViaPaypal: "Like it? Support me via PayPal:",
        saveAndClose: "Save & Close",
        close: "Close",
        calendar: "Calendar",
        start: "Start",
        end: "End",
        noTitle: "(no title)",
        languageLabel: "Language",
        systemDefault: "System default",
        donateWithPaypal: "Donate with PayPal",
        highlightToday: "Highlight current day",
        highlightTodayDescription: "Shade today's column with a subtle color.",
        themeLabel: "Appearance",
        themeSystem: "Match system",
        themeLight: "Light",
        themeDark: "Dark",
        resetData: "Reset stored data",
        resetDataDescription: "Remove saved colors, language, highlight, and theme preferences.",
        resetConfirmation: "Clear stored calendar settings? This cannot be undone.",
        trimUnusedHours: "Trim blank hours",
        trimUnusedHoursDescription: "Hide early and late hours without events while keeping 20% of the unused time visible."
    },
    de: {
        today: "Heute",
        allDay: "Ganztägig",
        allDayShort: "Ganztäg.",
        allDayAbbrev: "Tag",
        location: "Ort",
        description: "Beschreibung",
        calendarColors: "Kalenderfarben",
        supportViaPaypal: "Gefällt dir die Karte? Unterstütze mich via PayPal:",
        saveAndClose: "Speichern & Schließen",
        close: "Schließen",
        calendar: "Kalender",
        start: "Beginn",
        end: "Ende",
        noTitle: "(kein Titel)",
        languageLabel: "Sprache",
        systemDefault: "Systemstandard",
        donateWithPaypal: "Mit PayPal spenden",
        highlightToday: "Aktuellen Tag hervorheben",
        highlightTodayDescription: "Markiert die heutige Spalte mit einer sanften Farbe.",
        themeLabel: "Darstellung",
        themeSystem: "System übernehmen",
        themeLight: "Hell",
        themeDark: "Dunkel",
        resetData: "Gespeicherte Daten zurücksetzen",
        resetDataDescription: "Entfernt gespeicherte Farben, Sprache, Hervorhebung und Theme-Einstellungen.",
        resetConfirmation: "Gespeicherte Kalender-Einstellungen wirklich löschen? Dies kann nicht rückgängig gemacht werden.",
        trimUnusedHours: "Unbenutzte Randstunden kürzen",
        trimUnusedHoursDescription: "Blendet frühe und späte Stunden ohne Termine aus und lässt 20 % der freien Zeit sichtbar."
    },
    fr: {
        today: "Aujourd'hui",
        allDay: "Toute la journée",
        allDayShort: "Journée",
        allDayAbbrev: "Jour",
        location: "Lieu",
        description: "Description",
        calendarColors: "Couleurs du calendrier",
        supportViaPaypal: "Vous aimez ? Soutenez-moi via PayPal :",
        saveAndClose: "Enregistrer et fermer",
        close: "Fermer",
        calendar: "Calendrier",
        start: "Début",
        end: "Fin",
        noTitle: "(sans titre)",
        languageLabel: "Langue",
        systemDefault: "Langue du système",
        donateWithPaypal: "Faire un don avec PayPal",
        highlightToday: "Mettre en surbrillance aujourd'hui",
        highlightTodayDescription: "Colorer la colonne d'aujourd'hui avec une couleur subtile.",
        themeLabel: "Apparence",
        themeSystem: "Suivre le système",
        themeLight: "Clair",
        themeDark: "Sombre",
        resetData: "Réinitialiser les données enregistrées",
        resetDataDescription: "Supprime les couleurs, la langue, la mise en évidence et le thème sauvegardés.",
        resetConfirmation: "Effacer les paramètres enregistrés du calendrier ? Cette action est irréversible.",
        trimUnusedHours: "Réduire les heures vides",
        trimUnusedHoursDescription: "Masque les heures matinales et tardives sans événements tout en laissant 20 % du temps inutilisé visible."
    },
    es: {
        today: "Hoy",
        allDay: "Todo el día",
        allDayShort: "Todo día",
        allDayAbbrev: "Día",
        location: "Ubicación",
        description: "Descripción",
        calendarColors: "Colores del calendario",
        supportViaPaypal: "¿Te gusta? Apóyame vía PayPal:",
        saveAndClose: "Guardar y cerrar",
        close: "Cerrar",
        calendar: "Calendario",
        start: "Inicio",
        end: "Fin",
        noTitle: "(sin título)",
        languageLabel: "Idioma",
        systemDefault: "Predeterminado del sistema",
        donateWithPaypal: "Donar con PayPal",
        highlightToday: "Resaltar el día actual",
        highlightTodayDescription: "Sombrea la columna de hoy con un color sutil.",
        themeLabel: "Apariencia",
        themeSystem: "Usar el sistema",
        themeLight: "Claro",
        themeDark: "Oscuro",
        resetData: "Restablecer datos guardados",
        resetDataDescription: "Elimina los colores, el idioma, el resaltado y el tema guardados.",
        resetConfirmation: "¿Borrar la configuración guardada del calendario? Esta acción no se puede deshacer.",
        trimUnusedHours: "Recortar horas vacías",
        trimUnusedHoursDescription: "Oculta las horas tempranas y tardías sin eventos dejando visible el 20 % del tiempo sin usar."
    },
    it: {
        today: "Oggi",
        allDay: "Tutto il giorno",
        allDayShort: "Tutto giorno",
        allDayAbbrev: "Giorno",
        location: "Posizione",
        description: "Descrizione",
        calendarColors: "Colori del calendario",
        supportViaPaypal: "Ti piace? Sostienimi tramite PayPal:",
        saveAndClose: "Salva e chiudi",
        close: "Chiudi",
        calendar: "Calendario",
        start: "Inizio",
        end: "Fine",
        noTitle: "(senza titolo)",
        languageLabel: "Lingua",
        systemDefault: "Predefinito di sistema",
        donateWithPaypal: "Dona con PayPal",
        highlightToday: "Evidenzia il giorno corrente",
        highlightTodayDescription: "Colora la colonna di oggi con un colore tenue.",
        themeLabel: "Aspetto",
        themeSystem: "Come sistema",
        themeLight: "Chiaro",
        themeDark: "Scuro",
        resetData: "Reimposta i dati salvati",
        resetDataDescription: "Rimuove colori, lingua, evidenziazione e tema salvati.",
        resetConfirmation: "Eliminare le impostazioni salvate del calendario? L'operazione è irreversibile.",
        trimUnusedHours: "Riduci ore vuote",
        trimUnusedHoursDescription: "Nasconde le ore mattutine e serali senza eventi lasciando visibile il 20% del tempo inutilizzato."
    },
    nl: {
        today: "Vandaag",
        allDay: "Hele dag",
        allDayShort: "Hele d.",
        allDayAbbrev: "Dag",
        location: "Locatie",
        description: "Beschrijving",
        calendarColors: "Kalenderkleuren",
        supportViaPaypal: "Vind je het leuk? Steun me via PayPal:",
        saveAndClose: "Opslaan en sluiten",
        close: "Sluiten",
        calendar: "Agenda",
        start: "Start",
        end: "Einde",
        noTitle: "(geen titel)",
        languageLabel: "Taal",
        systemDefault: "Systeemstandaard",
        donateWithPaypal: "Doneren met PayPal",
        highlightToday: "Markeer de huidige dag",
        highlightTodayDescription: "Kleur de kolom van vandaag met een subtiele kleur.",
        themeLabel: "Weergave",
        themeSystem: "Volg systeem",
        themeLight: "Licht",
        themeDark: "Donker",
        resetData: "Opgeslagen gegevens resetten",
        resetDataDescription: "Verwijdert opgeslagen kleuren, taal, markering en thema-instellingen.",
        resetConfirmation: "Opgeslagen kalenderinstellingen wissen? Dit kan niet ongedaan worden gemaakt.",
        trimUnusedHours: "Lege uren inkorten",
        trimUnusedHoursDescription: "Verbergt vroege en late uren zonder afspraken en laat 20% van de vrije tijd zichtbaar."
    }
};

export const LANGUAGE_NAMES = {
    en: "English",
    de: "Deutsch",
    fr: "Français",
    es: "Español",
    it: "Italiano",
    nl: "Nederlands"
};

export const SUPPORTED_LANGUAGES = Object.keys(TRANSLATIONS);

export function normalizeLanguage(lang) {
    return (lang || "").toString().toLowerCase().split("-")[0];
}

export function getBrowserLanguages() {
    const languages = [];
    if (typeof navigator === "undefined") {
        return languages;
    }

    if (navigator.language) {
        languages.push(navigator.language);
    }

    if (Array.isArray(navigator.languages)) {
        navigator.languages.forEach(lang => {
            if (!languages.includes(lang)) {
                languages.push(lang);
            }
        });
    }

    return languages;
}

export function resolveLanguage(preference = "system", options = {}) {
    const {
        fallback = FALLBACK_LANGUAGE,
        supported = SUPPORTED_LANGUAGES,
        browserLanguages = getBrowserLanguages()
    } = options;

    if (preference && preference !== "system") {
        const normalizedPreference = normalizeLanguage(preference);
        if (supported.includes(normalizedPreference)) {
            return normalizedPreference;
        }
    }

    for (const lang of browserLanguages) {
        const normalized = normalizeLanguage(lang);
        if (supported.includes(normalized)) {
            return normalized;
        }
    }

    return fallback;
}

export function translate(locale, key) {
    const translations = TRANSLATIONS[locale] || TRANSLATIONS[FALLBACK_LANGUAGE];
    const fallbackTranslations = TRANSLATIONS[FALLBACK_LANGUAGE];
    return translations[key] || fallbackTranslations[key] || key;
}

export function getLanguageOptions() {
    return SUPPORTED_LANGUAGES.map(code => ({ code, label: LANGUAGE_NAMES[code] || code }));
}
